je_mosque_of_djenne_site = {
	icon = "gfx/interface/icons/event_icons/event_map.dds"

	group = je_group_technology

	on_monthly_pulse = {
		effect = {
			change_variable = {
				name = mosque_of_djenne_var
				add = 1
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = yes }
		any_scope_state = {
			is_incorporated = yes
			is_split_state = no
		}
		institution_investment_level = {
			institution = institution_schools
			value >= 5
		}
	}

	on_complete = {
		remove_modifier = mosque_of_djenne_survey
		trigger_event = { id = mosque_of_djenne.1 } # site found
	}

	invalid = {
		NOT = {
			any_scope_state = {
				is_incorporated = yes
				is_split_state = no
			}
			institution_investment_level = {
				institution = institution_schools
				value >= 5
			}
			has_global_variable = mosque_of_djenne_success_var
			any_scope_building = {
				is_building_type = building_mosque_of_djenne
			}
		}
	}

	on_invalid = {
		remove_modifier = mosque_of_djenne_survey
		remove_variable = mosque_of_djenne_var
	}

	current_value = {
		value = root.var:mosque_of_djenne_var
	}

	goal_add_value = {
		value = 1
	}

	progressbar = yes

	weight = 10

	should_be_pinned_by_default = yes
}

je_mosque_of_djenne_construction = {
	icon = "gfx/interface/icons/event_icons/event_map.dds"

	group = je_group_technology

	complete = {
		scope:target = {
			any_scope_building = {
				is_building_type = building_mosque_of_djenne
				is_under_construction = no
			}
		}
	}

	fail = {
		NOT = {
			any_scope_state = {
				has_modifier = mosque_of_djenne_site
			}
		}
	}
	
	on_fail = {
		remove_variable = mosque_of_djenne_var
	}

	on_complete = {
		remove_global_variable = mosque_of_djenne_var
		set_global_variable = mosque_of_djenne_success_var
		scope:target = {
			remove_modifier = mosque_of_djenne_site
		}
	}

	should_be_pinned_by_default = yes
}